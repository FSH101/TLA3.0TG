# Формат карты в JSON

Карты, которыми обмениваются сервер и клиенты, соответствуют интерфейсу `MapJSON` из пакета `@tla/shared`.

```ts
export interface MapJSON {
  id: string;
  size: { width: number; height: number };
  tiles: Array<{
    layer: "floor" | "wall" | "object";
    q: number;
    r: number;
    id: string;
    block?: boolean;
    light?: number;
    meta?: Record<string, unknown>;
  }>;
  spawns?: { player?: Hex[] };
  source?: { type: string; file?: string };
}
```

- **id** — уникальный идентификатор карты.
- **size** — размеры аксиальной сетки в гексагонах.
- **tiles** — разреженный список размещённых тайлов. Отсутствующие напольные тайлы заменяются заглушкой по умолчанию.
  - `layer` — слой отрисовки (floor, wall, object).
  - `q`, `r` — аксиальные координаты.
  - `id` — идентификатор тайла (пока заглушка, позже совпадёт с ключами в атласе спрайтов).
  - `block` — необязательный флаг непроходимости для будущего поиска пути.
  - `light` — необязательный коэффициент освещения (0..1).
  - `meta` — произвольные дополнительные сведения, например ссылки на переходы между картами.
- **spawns.player** — необязательный массив стартовых гексов для игроков.
- **source** — метаданные импорта (тип и оригинальное имя файла), полезны при конвертации из старого формата `.fomap`.

Редактор импортирует и экспортирует эту структуру в виде отформатированного JSON.
