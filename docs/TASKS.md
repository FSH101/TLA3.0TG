# Чек-лист задач проекта

Этот документ фиксирует обязательные результаты для MVP веб-ремейка Fallout, разбитые на отдельные pull request'ы,
чтобы работа шла поэтапно при всегда зелёном CI.

## Структура репозитория
- [x] Настроить npm workspaces с пакетами `server`, `client`, `shared` и `tools`.
- [x] Добавить строгие конфиги TypeScript, ESLint, Prettier и общие правила `.gitignore`.
- [ ] Подготовить конфиг Render (`render.yaml`) и GitHub Actions для CI и импорта карт.
- [x] Заполнить `packages/server/.env.example` всеми необходимыми переменными окружения.

## Тулы: импорт карт и ассетов
- [x] Реализовать парсер `.fomap` (`packages/tools/fomap-import.ts`), возвращающий структурированные данные карты.
- [x] Реализовать резолвер PID прототипов (`packages/tools/proto-resolve.ts`).
- [x] Собрать CLI-импортёр (`packages/tools/import-map.ts`), который пишет `assets/maps/<mapId>.json`.
- [x] Добавить утилиту `import-all` и npm-скрипты для пакетной генерации карт.
- [ ] Написать модульные тесты для инструментов импорта.

## Клиент: рантайм-декодирование FR/FRM
- [ ] Добавить модуль с канонической палитрой Fallout.
- [ ] Реализовать декодер FRM, возвращающий кэшируемые атласы с канвасами для каждого кадра.
- [ ] Настроить цепочку загрузки ассетов (сначала `.png|.gif`, затем `.frm|fr?`).
- [ ] Покрыть крайние случаи декодера модульными тестами.

## Серверная платформа
- [x] Подключить HTTP-сервер на Express со статикой и маршрутом `/art/**`, читающим оригинальные ассеты при отсутствии предконверта.
- [ ] Открыть REST-эндпоинты для здоровья, списка карт и деталей карты.
- [ ] Реализовать аутентификацию (register, login, refresh, logout, me) на Prisma, bcrypt, JWT, с refresh-cookie, rate limiting и проверкой через Zod.
- [ ] Настроить WebSocket `/ws` со специфицированным протоколом и состоянием мира в памяти.
- [ ] Вынести общие сетевые типы в `packages/shared/net.ts`.
- [ ] Добавить кэш загрузчика карт и вспомогательные функции гекс-координат с тестами.

## Клиентский игровой цикл
- [ ] Инициализировать приложение Vite + PixiJS с полноэкранным рендером гекс-карты, слоями и Z-сортировкой.
- [ ] Получать данные карты и рисовать ground, roof, объекты и игроков.
- [ ] Реализовать анимации персонажа на FRM (idle/walk, 6 направлений).
- [ ] Добавить обработку ввода для перемещения, поворота, чата и мобильного полноэкранного режима.
- [ ] Подключить WebSocket-клиент к протоколу: отправка/приём, интерполяция, оверлей пинга.
- [ ] Добавить минимальный UI для аутентификации и выбора карты.

## Деплой и контроль качества
- [ ] Добиться успешного выполнения `npm run lint`, `npm run typecheck` и `npm run build` локально и в CI.
- [ ] Задокументировать команды `npm run dev` и тестовый процесс в `README.md`.
- [ ] Подготовить команду запуска для Render и убедиться, что `/healthz` отвечает 200.
- [ ] Создать опциональный workflow конвертации FR→PNG/GIF (`packages/tools/fr2gif.ts`).

## Дорожная карта после MVP (для справки)
- [ ] Поиск пути (A*) с учётом занятых гексов.
- [ ] Разделение на инстансы карт и сохранение состояния мира.
- [ ] Боевая система, инвентарь и сценарные взаимодействия.
- [ ] Спрайтовые атласы, батчинг и оптимизации кэширования кадров FRM.
- [ ] Дополнительный провайдер авторизации через Telegram Mini App.
